{
    "rules": {
        ".read": "auth !== null && root.child('users').child(auth.uid).child('role').val() === 'ADMIN'",
        ".write": "auth !== null && root.child('users').child(auth.uid).child('role').val() === 'ADMIN'",
        "users": {
            "$uid": {
                ".read": "auth !== null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
                ".write": "auth !== null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
                "role": {
                    ".validate": "newData.val() === 'ADMIN' || newData.val() === 'USER'",
                    ".write": "root.child('users').child(auth.uid).child('role').val() === 'ADMIN'"
                }
            }
        },
        "lists": {
            "$listId": {
                ".read": "auth != null",
                ".write": "auth != null",
                ".validate": "newData.child('owner').val() === auth.uid",
                "owner": {
                    ".validate": "newData.isString() && newData.val() === auth.uid"
                },
                "collaborators": {
                    "$collaboratorUid": {
                        ".write": "root.child('lists').child($listId).child('owner').val() === auth.uid",
                        ".validate": "newData.isString()"
                    }
                },
                "title": {
                    ".validate": "newData.isString() && newData.val().length > 0"
                },
                "items": {
                    "$itemId": {
                        ".validate": "newData.hasChildren(['title', 'quantity', 'unitPrice'])",
                        "title": {
                            ".validate": "newData.isString() && newData.val().length > 0"
                        },
                        "quantity": {
                            ".validate": "newData.isNumber() && newData.val() > 0"
                        },
                        "unitPrice": {
                            ".validate": "newData.isNumber() && newData.val() >= 0"
                        }
                    }
                },
                "dateCreated": {
                    ".validate": "newData.isString() && newData.val().length > 0"
                },
                "totalAmount": {
                    ".validate": "newData.isNumber() && newData.val() >= 0"
                },
                "numItems": {
                    ".validate": "newData.isNumber() && newData.val() >= 0"
                }
            }
        },
        "items": {
            "$itemId": {
                ".read": "auth !== null && (auth.uid === data.child('owner').val() || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
                ".write": "auth !== null && (auth.uid === data.child('owner').val() || root.child('users').child(auth.uid).child('role').val() === 'ADMIN')",
                "owner": {
                    ".validate": "newData.val() === auth.uid"
                },
                "description": {
                    ".validate": "newData.isString() && newData.val().length > 0"
                },
                "unitValue": {
                    ".validate": "newData.isNumber() && newData.val() >= 0"
                },
                "lists": {
                    "$listId": {
                        ".validate": "root.child('lists').child($listId).exists()"
                    }
                }
            }
        }
    }
}